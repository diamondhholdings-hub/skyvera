# Fix Manifest ‚Äî 2026-02-19

## Audit Summary
- Total issues found: 63
- P0 (crashes/broken): 2
- P1 (visual/functional): 35
- P2 (polish): 22
- P3 (minor): 4
- Pages audited: 13

> Source reports: audit-agent-a.json (Agent A ‚Äî core pages), audit-agent-b.json (Agent B ‚Äî account plan vs Telstra reference), audit-agent-c.json (Agent C ‚Äî dm-strategy / product-agent / test-dm-tracker)

---

## Wave 0: Shared Component Fixes (MUST RUN FIRST)

These affect `globals.css`, `layout.tsx`, or `src/components/ui/*` files used by multiple pages.
All Wave 1 / Wave 2 / Wave 3 agents **MUST wait** for Wave 0 to be completed and committed before starting.

### DO NOT TOUCH list for all subsequent agents:
- `src/app/globals.css` (Wave 0 owns this)
- `src/app/layout.tsx` (Wave 0 owns this)
- `src/components/ui/*.tsx` (Wave 0 owns all shared UI components)

### Rationale for shared classification

| Issue ID | Reason shared |
|----------|--------------|
| dash-009 (kpi-card) | `shared_component: true` in audit; kpi-card.tsx consumed by dashboard and potentially any future page |
| acct-003 (health-indicator) | `shared_component: true`; HealthIndicator appears in /accounts list and /accounts/[name] hero subtitle |
| acct-017 / acct-030 (globals.css card hover) | `shared_component: true`; `.card-hover` in globals.css affects every page that uses the Card component |
| acct-017 (card.tsx) | The `::before` sweep animation missing from Card component itself |

### Issues to fix:

| ID | Severity | File | Description | Fix approach |
|----|----------|------|-------------|--------------|
| W0-001 | P2 | `src/components/ui/kpi-card.tsx` | Label text uses hardcoded `text-[#888]`, target text uses `text-[#aaa]`, positive delta badge uses `bg-[#2ecc71]/20 text-[#2ecc71]`, negative delta badge uses `bg-[#e74c3c]/20 text-[#e74c3c]`. None are editorial tokens. | In `kpi-card.tsx`: (1) Replace `text-[#888]` on the `<h3>` with `text-[var(--muted)]`. (2) Replace `text-[#aaa]` on the target `<span>` with `text-[var(--muted)]/80`. (3) Replace `bg-[#2ecc71]/20 text-[#2ecc71]` with `bg-[var(--success)]/20 text-[var(--success)]`. (4) Replace `bg-[#e74c3c]/20 text-[#e74c3c]` with `bg-[var(--critical)]/20 text-[var(--critical)]`. |
| W0-002 | P1 | `src/components/ui/health-indicator.tsx` | `healthConfig.green.color` is `'bg-green-500'` ‚Äî a raw Tailwind green ‚Äî while `yellow` uses `'bg-[var(--warning)]'` and `red` uses `'bg-[var(--critical)]'` (already correct). The inconsistency means the healthy dot does not respond to future theme changes. | In `health-indicator.tsx` line 16: change `color: 'bg-green-500'` to `color: 'bg-[var(--success)]'`. No other changes needed. |
| W0-003 | P2 | `src/app/globals.css` | `.card-hover:hover` uses `transform: translateY(-4px)`. The Telstra reference specification defines the card hover lift as `translateY(-2px)`. The current 4px lift is more aggressive than the reference design intends, and applies to every page that uses the Card component or the `.card-hover` class. | In `globals.css` line 147: change `transform: translateY(-4px)` to `transform: translateY(-2px)`. Also update `box-shadow` on hover from `0 12px 24px rgba(0,0,0,0.15)` to `0 4px 12px rgba(0,0,0,0.08)` to match the reference's subtler shadow. |
| W0-004 | P2 | `src/app/globals.css` | The `.skeleton` class uses hardcoded `#f0f0f0` and `#e0e0e0` hex colours that are not editorial tokens. These skeleton shimmer colours should derive from `var(--border)` and `var(--highlight)` so they remain coherent with the editorial palette. | In `globals.css` lines 136‚Äì139: replace the shimmer gradient values ‚Äî change `#f0f0f0` to `var(--highlight)` and `#e0e0e0` to `var(--border)`. This will also fix the downstream loading skeletons in accounts, alerts, query, and scenario that currently override with `bg-slate-200` (see Wave 2 notes). |
| W0-005 | P1 | `src/components/ui/card.tsx` | The Card component does not implement the `::before` top-border sweep hover animation present in the Telstra reference (a 3px gradient line `linear-gradient(90deg, var(--accent), var(--secondary))` that scales from scaleX(0) to scaleX(1) on hover). The card also uses `bg-white` for its background rather than `var(--paper)`, which means on a themed background it would show as stark white. | (1) In `card.tsx`: add `relative overflow-hidden` to the outer `<div>` className alongside the existing classes. (2) Add an absolutely-positioned `<span>` as the first child of the outer div with className `absolute top-0 left-0 w-full h-[3px] bg-gradient-to-r from-[var(--accent)] to-[var(--secondary)] scale-x-0 origin-left transition-transform duration-[600ms] ease-in-out group-hover:scale-x-1 pointer-events-none`. (3) Add `group` to the outer `<div>` className so the group-hover selector works. (4) Optionally replace `bg-white` with `bg-[var(--paper)]` for full token compliance. |

---

## Wave 1: Account Plan Fixes (run parallel with Wave 2)

Reference: `Telstra_Account_Plan_Interactive.html`
Files owned: `src/app/accounts/[name]/**`

> Wave 1 agents must NOT touch any file in `src/components/ui/` or `src/app/globals.css` ‚Äî those are owned by Wave 0.

### P0 ‚Äî Fix first within this wave:

**P0-001 (acct-000) ‚Äî Account plan page crashes with 404 for "British Telecommunications"**
- File: `src/app/accounts/[name]/page.tsx`
- Description: The page calls `notFound()` at line 86 when `getAllCustomersWithHealth()` returns no match for the URL-decoded name "British Telecommunications". The Playwright test navigated to this URL and received a hard 404, confirming the route is entirely non-functional for at least one real account.
- Fix approach: (1) In `getAllCustomersWithHealth()` or the name-matching logic in `page.tsx`, normalize both the URL-decoded param and the `customer_name` field to lowercase before comparison (e.g., `param.toLowerCase() === customer.customer_name.toLowerCase()`). (2) Also strip URL encoding artifacts ‚Äî decode using `decodeURIComponent(params.name)` before comparison. (3) Verify "British Telecommunications" exists as a `customer_name` value in the data source. If the data uses "BT" as the canonical name, either add an alias map or ensure the accounts list page links use the canonical name.

### P1 ‚Äî High priority:

| ID | Tab | File | Description | Fix approach |
|----|-----|------|-------------|--------------|
| W1-P1-001 (acct-001) | hero-header | `src/app/accounts/[name]/page.tsx` | Hero header lacks the decorative SVG grid texture overlay present in the Telstra reference. The reference uses a `::before` pseudo-element (or child div) with a white SVG grid pattern at opacity 0.5 covering the right 60% of the header. Current implementation header looks flat. | Add a child `<div>` inside the hero header div with `className="absolute top-0 right-0 w-[60%] h-full pointer-events-none opacity-50"` and `style={{ backgroundImage: "url(\"data:image/svg+xml,...\")" }}` using the SVG grid pattern from the Telstra reference. Ensure the hero header parent has `position: relative overflow-hidden`. |
| W1-P1-002 (acct-002) | hero-header | `src/app/accounts/[name]/page.tsx` | Hero shows 4 stat cards but wrong metrics. Currently: Total Revenue, Recurring Revenue, Non-Recurring Revenue, Health Score. Reference shows: Total ARR, Account Rank, Health Score, Champion Status. Also missing sub-labels under each value (e.g., "8.3% of Cloudsense", "Largest Customer", "Medium-High", "Nathan Bell Departed"). | Replace the 4 stat cards: (1) "Total ARR" ‚Äî compute as `customer.recurringRevenue * 4`, sub-label `"${(arr/totalBuArr*100).toFixed(1)}% of ${customer.businessUnit}"`. (2) "Account Rank" ‚Äî use `customer.rank`, sub-label `"Largest Customer"` or rank ordinal. (3) "Health Score" ‚Äî keep but show as numeric (e.g. "7.5/10") with qualitative sub-label. (4) "Champion Status" ‚Äî derive from account plan relationship data, show "AT RISK" or similar with a sub-label. Add a second line `<p>` element inside each stat card for the sub-label, styled at `text-sm opacity-70`. |
| W1-P1-003 (acct-004) | hero-header | `src/app/accounts/[name]/page.tsx` | Subtitle line uses Badge components and HealthIndicator inline, making it visually inconsistent with the Telstra reference which shows a plain-text `"{BU} Business Unit | Skyvera | Q1 2026"` at opacity 0.85. | Replace the Badge and HealthIndicator in the subtitle with a single `<p>` element: `{customer.businessUnit} Business Unit | Skyvera | Q1 2026` with `className="text-paper/85 text-[1.1rem] mt-1"`. Move health display to the stat card only. |
| W1-P1-004 (acct-007) | overview | `src/app/accounts/[name]/_components/overview-tab.tsx` | Two Chart.js charts present in the Telstra reference (ARR by Entity doughnut, Customer Concentration pie) are completely absent from the Overview tab. These take up a full 2-column grid row in the reference. | Add a chart section below the Account Summary grid in `overview-tab.tsx`. Implement using recharts (already in the project based on Agent C noting recharts usage) or Chart.js. Doughnut chart: ARR split by subscription entity using `customer.subscriptions` data. Pie chart: this customer's ARR vs. total BU ARR. Wrap both in a `<div className="grid grid-cols-2 gap-6">` with each chart in a Card at `height: 350px`. |
| W1-P1-005 (acct-009) | overview | `src/app/accounts/[name]/_components/overview-tab.tsx` | Risk & Opportunity Summary card is absent. Telstra reference has a two-section card with "Top Risks" (var(--critical) heading, bulleted list) and "Top Opportunities" (var(--success) heading, bulleted list). Current Quick Intelligence card shows raw markdown text instead. | Replace or augment the Quick Intelligence card with a Risk & Opportunity Summary card. Structure: `<Card title="Risk & Opportunity Summary">` containing (1) `<h3 style={{color:'var(--critical)'}}>Top Risks</h3>` + `<ul>` of top 3 items from `accountData.strategy.painPoints`. (2) `<h3 style={{color:'var(--success)'}}>Top Opportunities</h3>` + `<ul>` of top 3 from `accountData.strategy.opportunities`. |
| W1-P1-006 (acct-012) | organization | `src/app/accounts/[name]/_components/organization-tab.tsx`, `stakeholder-card.tsx`, `tab-navigation.tsx` | The Telstra reference has TWO org tabs: "Key Executives" (decision matrix, expandable accordions, relationship actions table) and "Org Structure" (org chart). Current implementation has one combined "Organization" tab showing only the tree org chart. The 2x2 decision matrix, executive accordions, and relationship actions table are entirely absent. | (1) In `tab-navigation.tsx`: split the single "Organization" tab into two: `{ key: 'key-executives', label: 'üëî Key Executives' }` and `{ key: 'org-structure', label: 'üè¢ Org Structure' }`. (2) Create a new `key-executives-tab.tsx` component that renders: a 2x2 decision maker/influencer matrix (CSS grid, 4 quadrants color-coded by supporter/detractor √ó DM/influencer), expandable accordion per stakeholder (toggle open/closed, show profile table + strategic context callout + key message block), and a relationship actions data table with 30/60/90 day timeline badges. (3) Rename the existing `organization-tab.tsx` to clearly own only the org chart. |
| W1-P1-007 (acct-014) | strategy | `src/app/accounts/[name]/_components/strategy-tab.tsx` | Pain points rendered as card grid is missing 4 of 6 columns from the Telstra reference table (Owner, Budget, CloudSense Solution, Next Action). The "Strategic Initiatives" section is entirely absent. | (1) Extend the PainPoint data type to add `budget?: boolean`, `solution?: string`, `nextAction?: string`, `owner?: string` fields. (2) Replace or add a tabular view option in StrategyTab: render a `<table>` with columns "Identified Pain | Customer Owner | Urgency | Budget | CloudSense Solution | Next Action". Style as a `.data-table` with `border-collapse: separate; font-size: 0.95rem`. (3) Add a "Strategic Initiatives" section below using `accountData.strategy.opportunities` as source data, rendered as a 2-column card grid (matching the Telstra 4-card `grid-2` layout). |
| W1-P1-008 (acct-016) | competitive | `src/app/accounts/[name]/_components/competitive-tab.tsx` | The Telstra reference has 4 competitive sections: (1) 6-column competitor threat table, (2) Competitive Advantages metrics-grid (6 boxes), (3) Defensive Strategy ordered list, (4) Competitive Risk Timeline table. Current implementation shows only a two-column card split (Our Competitors / Customer's Market Rivals) and a count summary card. | (1) Extend the Competitor data type with `threatLevel`, `customerSponsor`, `risk`, `differentiation`, `nextAction` fields. (2) Add a data table above the existing card view with columns: Competitor | Threat Level (badge) | Customer Sponsor | Risk | How We Differentiate | Next Action. (3) Add a "Competitive Advantages" section: 6 `.metric-box`-style boxes in a 3-column grid using editorial token styles. (4) Add "Defensive Strategy" ordered list section. (5) Add "Competitive Risk Timeline" 5-column table (Risk Event | Probability | Impact | Timing | Mitigation). |
| W1-P1-009 (acct-018) | action-items | `src/app/accounts/[name]/_components/action-items-tab.tsx` | The Telstra reference Action Plan has a centered vertical timeline for 30/60/90 day phases (center line, alternating left/right items, accent circle markers) PLUS a 6-column data table, PLUS a Key Messages by Stakeholder grid, PLUS an Escalation Triggers card. Current implementation has only a Kanban board. The timeline, data table, key messages, and escalation sections are all absent. | (1) Add a "30/60/90 Day Plan" section above the Kanban using a CSS timeline: a relative container with a centered vertical `::before` pseudo-line (or a `<div>` with `absolute left-1/2 top-0 bottom-0 w-0.5 bg-[var(--border)]`), alternating left/right `<div>` items (odd: `mr-auto pr-8 text-right`, even: `ml-auto pl-8`), each with a circular accent marker (`w-4 h-4 bg-[var(--accent)] rounded-full absolute left-1/2 -translate-x-1/2`). (2) Add a 6-column action data table below the Kanban (Action | Owner | Target/Outcome | Timeline | Priority badge | Status badge). (3) Add Key Messages by Stakeholder section (see W1-P2-006 below). (4) Add Escalation Triggers card (see W1-P2-007 below). |
| W1-P1-010 (acct-020) | financials | `src/app/accounts/[name]/_components/financials-tab.tsx` | Financial tab is missing 4 of 5 reference sections: (2) ARR Growth Projection + Top 10 Customers comparison charts, (3) Strategic Impact Analysis metrics-grid (6 boxes), (4) Expansion Opportunities table, (5) Company Overview 2√ó2 data grid. Also the existing contract table is missing Start Date, End Date, Growth % badge columns and a highlight-row totals row. | (1) Add Start Date, End Date, and Growth % badge columns to the subscriptions table. Add a highlight-row totals row at the bottom (`bg-[rgba(200,75,49,0.08)] font-semibold`). (2) Add 2 recharts bar charts: Revenue Growth Projection (current ARR vs upsell potential vs full upside) and a peer comparison bar chart. (3) Add Strategic Impact Analysis: 6 metric-box divs in a 3-column grid (`bg-[var(--highlight)] border-l-4 border-[var(--accent)]`) for churn impact, concentration %, upsell opportunity, total upside, payment behavior, etc. (4) Add Expansion Opportunities 5-column table (Opportunity | Description | Revenue Potential | Probability badge | Timeline). (5) Add Company Overview 2√ó2 data grid at the bottom. |

### P2 ‚Äî Lower priority:

| ID | Tab | File | Description | Fix approach |
|----|-----|------|-------------|--------------|
| W1-P2-001 (acct-003) | hero-header | `src/app/accounts/[name]/page.tsx` | Stat card values use `text-2xl` (1.5rem) but Telstra reference specifies `2rem` for stat values. Cards also lack `backdrop-filter: blur(10px)` ‚Äî current `bg-white/10` has no blur. | Add `backdrop-blur-sm` (or `style={{backdropFilter:'blur(10px)'}}`) to each stat card `<div>`. Change stat value text from `text-2xl` to `text-[2rem]` to match the reference. |
| W1-P2-002 (acct-005) | tab-navigation | `src/app/accounts/[name]/_components/tab-navigation.tsx` | Active tab background uses `bg-accent/5` (light terracotta tint). Reference uses `var(--paper)` (#fafaf8) ‚Äî the off-white page background ‚Äî making the active tab appear to seamlessly connect to page content. | In `tab-navigation.tsx`: change the active tab background class from `bg-accent/5` (or whichever tinted class is present) to `bg-[var(--paper)]`. Keep `text-[var(--accent)] border-b-2 border-[var(--accent)]` for the active colour and underline. |
| W1-P2-003 (acct-006) | tab-navigation | `src/app/accounts/[name]/_components/tab-navigation.tsx` | Tab labels differ from the Telstra reference. Reference: üìä Overview, üëî Key Executives, üè¢ Org Structure, üí° Pain Points, ‚öîÔ∏è Competitive, üìã Action Plan, üí∞ Financial. Current: üìä Overview, üè¢ Organization, üí° Strategy & Pain Points, ‚öîÔ∏è Competitive, üìã Action Plan, üí∞ Financial, üîç Intelligence. | In `tab-navigation.tsx` update tab label copy to match reference exactly (see W1-P1-006 for the org split). Rename "Strategy & Pain Points" to "üí° Pain Points". The Intelligence tab (üîç) is an additive tab not in reference ‚Äî retain but move to last position. Rename "Action Plan" copy to "üìã Action Plan" if not already matching. |
| W1-P2-004 (acct-008) | overview | `src/app/accounts/[name]/_components/overview-tab.tsx` | "Keys to Success" priority items render the priority label at `text-base` (1rem). Telstra reference uses `1.3rem` for the priority label value. | Change the priority value text class from `text-base` to `text-[1.3rem]` within the Keys to Success card items. |
| W1-P2-005 (acct-010) | overview | `src/app/accounts/[name]/_components/overview-tab.tsx` | Alert banner has `rounded` and `shadow-lg` ‚Äî the Telstra reference alert banner is sharp-edged (no border-radius) with only a left accent border and specific box-shadow. | Remove `rounded` from the alert banner div. Replace `shadow-lg` with `style={{boxShadow:'0 4px 12px rgba(197,75,49,0.2)'}}`. Add `style={{margin:'-1rem 0 3rem'}}` to pull the banner flush with the tab bar above it. |
| W1-P2-006 (acct-026) | action-items | `src/app/accounts/[name]/_components/action-items-tab.tsx` | "Key Messages by Stakeholder" section is absent. Reference: a 2√ó2 grid of highlight boxes (`bg-[var(--highlight)] border-l-3 border-[var(--accent)]`), one per key stakeholder with `<h4>To [Name] ([Role])</h4>` and message text. | Add below the Kanban board: `<Card title="Key Messages by Stakeholder"><div className="grid grid-cols-2 gap-4">` with 4 boxes. Source from `accountData.stakeholders` (first 4 decision makers/influencers). Each box: `<div className="p-6 bg-[var(--highlight)] border-l-[3px] border-[var(--accent)]"><h4 className="font-display font-semibold text-[var(--secondary)] mb-2">To {name} ({role})</h4><p className="text-sm text-[var(--ink)]">{keyMessage}</p></div>`. |
| W1-P2-007 (acct-027) | action-items | `src/app/accounts/[name]/_components/action-items-tab.tsx` | Escalation Triggers card is absent. Reference: a card with `border-left: 4px solid var(--critical)`, warning heading, and 6 bulleted trigger conditions. | Add at the bottom of `ActionItemsTab`: `<div className="border-l-4 border-[var(--critical)] bg-white rounded p-6 shadow-sm"><h3 className="font-display font-semibold text-[var(--ink)]">‚ö† Escalation Triggers to Skyvera Leadership</h3><p className="text-sm text-[var(--muted)] mb-3">Escalate immediately if any of the following occur:</p><ul className="list-disc pl-5 space-y-1 text-sm text-[var(--ink)]">` populated from a new `escalationTriggers` field in account plan data, or from health score / renewal proximity logic. |
| W1-P2-008 (acct-019) | action-items | `src/app/accounts/[name]/_components/action-card.tsx` | ActionCard lacks the left accent border that the Telstra reference action items use. Done/completed cards should have reduced opacity and switch the border to `var(--success)`. | In `action-card.tsx`: add `border-l-4 border-[var(--accent)]` to the card outer div className. For cards with `status === 'done'` or `status === 'completed'`, add `opacity-60` and change border to `border-l-[var(--success)]`. |
| W1-P2-009 (acct-013) | organization | `src/app/accounts/[name]/_components/organization-tab.tsx`, `stakeholder-card.tsx` | Org chart uses indented list layout. Reference renders stakeholders in horizontal grid rows per organizational level. Org nodes use left-border-only; reference uses full-perimeter `border-2 border-[var(--secondary)]` with `min-width: 250px` and `box-shadow: 0 2px 8px rgba(0,0,0,0.1)`. | In `organization-tab.tsx`: change rendering from nested indented list to grouped horizontal grid rows (group by `stakeholder.level` or `stakeholder.reportsTo` hierarchy). In `stakeholder-card.tsx` (for the Org Structure tab only): replace `border-l-4 border-l-accent` with `border-2 border-[var(--secondary)]` and add `min-w-[250px] shadow-[0_2px_8px_rgba(0,0,0,0.1)]`. |
| W1-P2-010 (acct-015) | strategy/competitive | `src/app/accounts/[name]/_components/strategy-tab.tsx`, `competitive-tab.tsx` | Empty-state panels use `bg-slate-50 border-slate-200 text-slate-600` hardcoded Tailwind classes instead of editorial tokens. | In both files: replace `bg-slate-50` ‚Üí `bg-[var(--highlight)]`, `border-slate-200` ‚Üí `border-[var(--border)]`, `text-slate-600` ‚Üí `text-[var(--muted)]`, `text-slate-700` ‚Üí `text-[var(--ink)]`. |
| W1-P2-011 (acct-021) | financials | `src/app/accounts/[name]/_components/financials-tab.tsx` | Financial table lacks border-collapse, correct font-size (0.95rem), and 1rem cell padding matching the reference. | In `financials-tab.tsx`: add `style={{borderCollapse:'separate', borderSpacing:0, fontSize:'0.95rem'}}` to the `<table>`. Change `th` and `td` from `py-3 px-4` to `p-4` (equivalent to 1rem all sides). |
| W1-P2-012 (acct-028) | tab-navigation | `src/app/accounts/[name]/_components/tab-navigation.tsx` | Sticky nav container uses `shadow-sm` (1px shadow) but the Telstra reference specifies `box-shadow: 0 2px 8px rgba(0,0,0,0.05)` ‚Äî a more visible horizontal shadow that helps the tab bar lift above content on scroll. | Replace `shadow-sm` with `shadow-[0_2px_8px_rgba(0,0,0,0.05)]` on the sticky outer nav container div. |
| W1-P2-013 (acct-022) | intelligence | `src/app/accounts/[name]/_components/intelligence-tab.tsx` | Intelligence tab content renders as raw `whitespace-pre-wrap` text (truncated 2000 chars). Should be upgraded to structured sections (Opportunities, Risks, Recommendations) and the news timeline should use the alternating left/right CSS timeline pattern. | Parse `IntelligenceReport` structured fields (opportunities, risks, recommendations) into three distinct card sections with color-coded headings. Convert news feed from a vertical card list to an alternating CSS timeline matching the Action Plan reference timeline style (see W1-P1-009 for timeline pattern). |

### P3 ‚Äî Minor polish:

| ID | Tab | File | Description | Fix approach |
|----|-----|------|-------------|--------------|
| W1-P3-001 (acct-023) | intelligence | `src/app/accounts/[name]/_components/intelligence-tab.tsx` | `Lightbulb` and `Target` are imported from `lucide-react` but never rendered. Empty state uses `bg-slate-50 border-slate-200 text-slate-600`. | Remove unused `Lightbulb` and `Target` imports. Replace `bg-slate-*` empty state classes with editorial tokens: `bg-[var(--highlight)]`, `border-[var(--border)]`, `text-[var(--muted)]`. |
| W1-P3-002 (acct-024) | organization | `src/app/accounts/[name]/_components/organization-tab.tsx` | Empty state uses `text-slate-700`, `text-slate-500`. Summary cards use `bg-white` instead of editorial background. Connector lines use `border-slate-300`. Relationship colour dots use `bg-green-500`, `bg-amber-500`, `bg-red-500`. | Replace: `text-slate-700` ‚Üí `text-[var(--secondary)]`, `text-slate-500` ‚Üí `text-[var(--muted)]`, `border-slate-300` ‚Üí `border-[var(--border)]`, `bg-green-500` ‚Üí `bg-[var(--success)]`, `bg-amber-500` ‚Üí `bg-[var(--warning)]`, `bg-red-500` ‚Üí `bg-[var(--critical)]`, `bg-white` ‚Üí `bg-[var(--paper)]` on summary cards. |
| W1-P3-003 (acct-025) | strategy | `src/app/accounts/[name]/_components/strategy-tab.tsx` | PainPointCard h3 title and OpportunityCard h3 title lack `font-display` class (Cormorant Garamond). All card headings in the reference use the serif display font. | Add `font-display` class to the `<h3>` elements in PainPointCard and OpportunityCard components. |
| W1-P3-004 (acct-029) | all | `src/app/accounts/[name]/page.tsx` | The account plan page has no footer. The Telstra reference has a `bg-[var(--secondary)] text-[var(--paper)]` centred footer with account name, BU, generated date, and confidentiality notice. | Add a `<footer>` element at the bottom of the account plan page layout (after the tab content container), with `className="bg-[var(--secondary)] text-[var(--paper)] text-center py-8 mt-16"`. Content: `<p>{account.name} Strategic Account Plan | {account.businessUnit} Business Unit | Skyvera</p><p>Generated: {new Date().toLocaleDateString()} | Confidential ‚Äî Internal Use Only</p>`. |

---

## Wave 2: Core Page Fixes (run parallel with Wave 1)

Files owned: `src/app/dashboard/**`, `src/app/accounts/page.tsx`, `src/app/accounts/components/**`, `src/app/accounts/loading.tsx`, `src/app/accounts/error.tsx`, `src/app/alerts/**`, `src/app/query/**`, `src/app/scenario/**`, `src/app/page.tsx`

> Wave 2 agents must NOT touch any file in `src/components/ui/` or `src/app/globals.css` ‚Äî those are owned by Wave 0.

### /dashboard

| ID | Severity | File | Description | Fix approach |
|----|----------|------|-------------|--------------|
| W2-D-001 (dash-001/002) | P1 | `src/app/dashboard/page.tsx` | Page outer wrapper uses `style={{background:'linear-gradient(135deg, #1e3c72 0%, #2a5298 100%)'}}` as a full-page backdrop AND the header also uses this same inline gradient. Both violate the design system. The blue-gradient-outer + white-card-inner layout is unique to this page and inconsistent with all other pages. | (1) Remove the outer blue gradient wrapper `<div>` entirely. (2) Remove the inline `style` background on the header element. (3) Replace the header element's background with Tailwind class `bg-gradient-to-br from-[var(--secondary)] to-[#1a2332]`. (4) Let the page body `var(--paper)` be the base background, consistent with other pages. |
| W2-D-002 (dash-005) | P1 | `src/app/dashboard/page.tsx` | Header `<h1>` uses `style={{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif', fontWeight:700}}` ‚Äî overrides Cormorant Garamond. Container div also sets `fontFamily` via inline style. | (1) Remove the `fontFamily` inline style from the outer container `<div>`. (2) Remove the `fontFamily` and `fontWeight` inline styles from the `<h1>` element. (3) Add `font-display` className to the `<h1>` so it inherits Cormorant Garamond from globals.css. |
| W2-D-003 (dash-006) | P1 | `src/app/dashboard/page.tsx` | Entire content (header + nav + sections + footer) is wrapped in a white rounded card with `boxShadow: '0 20px 60px rgba(0,0,0,0.3)'`. This nested card-within-page structure is unique to this page. | Remove the nested white-card wrapper `<div>`. Let sections render directly inside the page container using `className="max-w-[1400px] mx-auto px-8"` consistent with other pages. |
| W2-D-004 (dash-007) | P1 | `src/app/dashboard/page.tsx`, `src/app/dashboard/components/dashboard-navigation.tsx` | `DashboardNavigation` uses `useSearchParams()` but is not wrapped in its own `Suspense` boundary. In Next.js 14+, `useSearchParams()` outside a `Suspense` boundary causes a full-page suspend during SSR, showing a blank screen instead of navigation on first load. | In `dashboard/page.tsx`, wrap the `<DashboardNavigation />` render in its own `<Suspense fallback={<div className="h-10 bg-[var(--border)] animate-pulse rounded" />}>` boundary, separate from any outer Suspense. |
| W2-D-005 (dash-003) | P1 | `src/app/dashboard/components/dashboard-navigation.tsx` | Navigation buttons use hardcoded inline style colors: active button `#1e3c72`, inactive `#667eea`, hover `#764ba2`. These are entirely outside the design system. | Replace all inline `style` color values on navigation buttons: active button ‚Üí `style={{background:'var(--secondary)'}}` or `className="bg-[var(--secondary)]"`. Inactive buttons ‚Üí `className="bg-[var(--muted)]/30"`. Hover ‚Üí use Tailwind `hover:bg-[var(--secondary)]/80`. Remove all hardcoded hex `style` props from this component. |
| W2-D-006 (dash-004) | P1 | `src/app/dashboard/sections/financial-summary.tsx` | Section uses numerous hardcoded hex colors in inline styles: `h2` border `#667eea`, issue block border `#667eea`, table header background `#1e3c72`, variance badge colors `#f5576c`, `#fa709a`, `#4facfe`, `h3` color `#2a5298`. | Replace all hardcoded hex inline style colors: `#667eea` borders ‚Üí `var(--secondary)`, `#1e3c72` table header bg ‚Üí `var(--secondary)`, `#f5576c`/`#fa709a` (negative/warning badges) ‚Üí `var(--critical)`, `#4facfe` (positive badges) ‚Üí `var(--success)`, `#2a5298` h3 color ‚Üí `var(--secondary)`. |
| W2-D-007 (dash-008) | P2 | `src/app/dashboard/page.tsx` | `DashboardSkeleton` fallback uses `bg-slate-100` ‚Äî a generic Tailwind color. | In the `DashboardSkeleton` component inside `dashboard/page.tsx`, replace all instances of `bg-slate-100` with `bg-[var(--border)]`. |

### /accounts (directory page)

| ID | Severity | File | Description | Fix approach |
|----|----------|------|-------------|--------------|
| W2-A-001 (acct-001) | P1 | `src/app/accounts/components/account-table.tsx` | Customer name links use `text-blue-600 hover:text-blue-800` ‚Äî raw Tailwind blue classes, not editorial tokens. | In `account-table.tsx` line ~64, replace `text-blue-600 hover:text-blue-800` on the customer name link `<a>` or `<Link>` with `text-[var(--accent)] hover:text-[var(--accent)]/80 hover:underline`. |
| W2-A-002 (acct-002) | P1 | `src/app/accounts/components/account-filters.tsx` | Active health filter buttons use `bg-green-600 border-green-600`, `bg-yellow-600 border-yellow-600`, `bg-red-600 border-red-600` ‚Äî raw Tailwind color classes. | Replace: `bg-green-600 border-green-600` ‚Üí `bg-[var(--success)] border-[var(--success)]`, `bg-yellow-600` ‚Üí `bg-[var(--warning)]`, `bg-red-600` ‚Üí `bg-[var(--critical)]`. Note: after Wave 0 fixes `health-indicator.tsx`, the dot color in the filter buttons will also be corrected. |
| W2-A-003 (acct-004) | P1 | `src/app/accounts/components/account-stats.tsx` | Hardcoded string literal `'$12.6M'` for Total Revenue stat on line ~21. This is a stale static value that will not update when data changes. | Remove the hardcoded `'$12.6M'` string. Compute `totalRevenue` from `stats` prop data (sum of all customer revenue values) or add a `totalRevenue` field to the `AccountStats` props interface sourced from the server-side data aggregation layer. Format dynamically as currency. |
| W2-A-004 (acct-005) | P2 | `src/app/accounts/page.tsx` | Error state UI uses `bg-red-50 border-red-200 text-red-800 text-red-600` ‚Äî raw Tailwind red classes. | Replace: `bg-red-50` ‚Üí `bg-[var(--critical)]/5`, `border-red-200` ‚Üí `border-[var(--critical)]/30`, `text-red-800` ‚Üí `text-[var(--critical)]`, `text-red-600` ‚Üí `text-[var(--critical)]`, remaining body text ‚Üí `text-[var(--ink)]`. |
| W2-A-005 (acct-006) | P2 | `src/app/accounts/loading.tsx` | Loading skeleton uses `bg-slate-200`, `border-slate-200`, `bg-slate-50`, `bg-slate-50 border-b border-slate-200` throughout. | Replace: `bg-slate-200` ‚Üí `bg-[var(--border)]`, `bg-slate-50` ‚Üí `bg-[var(--highlight)]`, `border-slate-200` ‚Üí `border-[var(--border)]`. |

### /alerts

| ID | Severity | File | Description | Fix approach |
|----|----------|------|-------------|--------------|
| W2-AL-001 (alrt-001) | P1 | `src/app/alerts/components/alert-summary.tsx` | The alert summary SVG bell icon renders at an enormous size in the screenshot, likely because the SVG element has no explicit `width`/`height` attributes and the parent flex container is not constraining it. The `w-8 h-8` Tailwind constraint is being overridden. | In `alert-summary.tsx`, find the `<svg>` bell element and: (1) Add explicit `width="32" height="32"` attributes directly on the `<svg>` tag in addition to Tailwind `w-8 h-8`. (2) Add `flex-shrink-0` to the `<svg>` or its parent `<span>`. (3) If the bell is a lucide-react `<Bell />` component, ensure it receives `className="w-8 h-8 flex-shrink-0"` and `size={32}` props explicitly. |
| W2-AL-002 (alrt-002) | P1 | `src/app/alerts/components/alert-list.tsx` | Alert cards render in a single column despite `grid grid-cols-1 lg:grid-cols-2 gap-4`. The `lg:` breakpoint (1024px) may not activate if the Playwright viewport is sub-1024px, or the grid is being constrained by a parent container. | In `alert-list.tsx`, change `lg:grid-cols-2` to `md:grid-cols-2` (768px threshold) to ensure the 2-column grid activates at a wider range of viewports. Also verify no parent `<div>` has `overflow-hidden` or `max-width` that would suppress the grid expansion. |
| W2-AL-003 (alrt-003) | P2 | `src/app/alerts/loading.tsx` | Loading skeleton uses `bg-slate-200 animate-pulse rounded-lg`. | Replace `bg-slate-200` with `bg-[var(--border)]` in `alerts/loading.tsx`. |

### /query

| ID | Severity | File | Description | Fix approach |
|----|----------|------|-------------|--------------|
| W2-Q-001 (qry-001) | P1 | `src/app/query/components/query-page-client.tsx` | The `QueryInput` form is not visible above the empty state SVG in the screenshot. It may be rendering below the empty state placeholder due to DOM order, or a CSS `overflow`/`min-height` issue is pushing it out of the initial viewport. | In `query-page-client.tsx`: verify that `<QueryInput />` appears BEFORE `<QueryResults />` (or the empty state) in the JSX. The `space-y-6` parent should show the input at the top. If `QueryResults` has a `min-height: 100vh` or similar style, remove it. If the layout uses flexbox, ensure `QueryInput` is not `order-2` or otherwise displaced. |
| W2-Q-002 (qry-002) | P1 | `src/app/query/loading.tsx` | Loading skeleton uses `bg-slate-200 animate-pulse rounded-lg`. | Replace `bg-slate-200` with `bg-[var(--border)]` throughout `query/loading.tsx`. |
| W2-Q-003 (qry-003) | P2 | `src/app/query/components/metrics-catalog.tsx` | Collapsed MetricsCatalog button renders at excessive height in screenshot. The chevron SVG may not be size-constrained. | In `metrics-catalog.tsx`, ensure the chevron icon element has `className="w-5 h-5"` and the parent accordion button has `py-3` padding (not `py-6`+). Confirm the `ChevronDown` or similar icon has an explicit `size={20}` prop. |

### /scenario

| ID | Severity | File | Description | Fix approach |
|----|----------|------|-------------|--------------|
| W2-S-001 (scen-001) | P1 | `src/app/scenario/components/conversational-scenario.tsx` | Extensive use of generic Tailwind classes throughout: `bg-gradient-to-r from-blue-50 to-purple-50`, `text-slate-900/600/700/400`, `border-slate-200`, `bg-slate-100/50`, `bg-blue-600`, `border-slate-300`, `focus:border-blue-500 focus:ring-blue-200`, `bg-blue-600 hover:bg-blue-700`, `focus:ring-blue-500`, `bg-slate-50`, etc. | Systematic replacement throughout `conversational-scenario.tsx`: (1) `text-slate-900` ‚Üí `text-[var(--ink)]`. (2) `text-slate-700` ‚Üí `text-[var(--ink)]`. (3) `text-slate-600` ‚Üí `text-[var(--muted)]`. (4) `text-slate-400` ‚Üí `text-[var(--muted)]/60`. (5) `bg-slate-100`/`bg-slate-50` ‚Üí `bg-[var(--highlight)]`. (6) `border-slate-200`/`border-slate-300` ‚Üí `border-[var(--border)]`. (7) `bg-blue-600`/`bg-blue-700` (user message bubbles, send button, active buttons) ‚Üí `bg-[var(--secondary)]`. (8) `hover:bg-slate-50`/`hover:bg-slate-100` ‚Üí `hover:bg-[var(--highlight)]`. (9) `hover:border-blue-300` ‚Üí `hover:border-[var(--accent)]/50`. (10) `focus:border-blue-500 focus:ring-blue-200` on input ‚Üí `focus:border-[var(--accent)] focus:ring-[var(--accent)]/20`. (11) `from-blue-50 to-purple-50` header gradient ‚Üí `from-[var(--secondary)]/5 to-[var(--secondary)]/10`. (12) `border-blue-200` ‚Üí `border-[var(--secondary)]/20`. |
| W2-S-002 (scen-002) | P1 | `src/app/scenario/components/conversational-scenario.tsx` | Heading colors and font-display usage: main h2 uses `text-slate-900`, "Scenario Versions" h3 uses `text-slate-900 font-semibold` without `font-display`, Sparkles icon uses `text-purple-600`. | In `conversational-scenario.tsx`: (1) On the main h2 element: replace `text-slate-900` with `text-[var(--ink)]`. (2) On the "Scenario Versions" h3: add `font-display` class and replace `text-slate-900` with `text-[var(--ink)]`. (3) On the Sparkles icon: replace `text-purple-600` with `text-[var(--accent)]`. |
| W2-S-003 (scen-003) | P2 | `src/app/scenario/loading.tsx` | `ScenarioLoading` uses `bg-slate-200` for all skeleton pulse elements. | Replace all `bg-slate-200` instances with `bg-[var(--border)]` in `scenario/loading.tsx`. |
| W2-S-004 (scen-004) | P2 | `src/app/scenario/components/scenario-mode-selector.tsx` | Active mode toggle button uses `bg-gradient-to-r from-[var(--accent)] to-[var(--secondary)]` ‚Äî a red-to-navy gradient that creates a jarring orange-to-blue sweep. All other gradients in the app go from secondary (navy) to darker navy. | In `scenario-mode-selector.tsx`, change the active button gradient from `from-[var(--accent)] to-[var(--secondary)]` to `bg-gradient-to-br from-[var(--secondary)] to-[#1a2332]` for consistency with the editorial gradient direction. |
| W2-S-005 (scen-005) | P2 | `src/app/scenario/error.tsx`, `src/app/accounts/error.tsx` | Both error boundaries use `text-slate-900` for headings and `bg-blue-600 hover:bg-blue-700` for the retry button. | In both files: replace `text-slate-900` with `text-[var(--ink)]`, replace `bg-blue-600 hover:bg-blue-700` with `bg-[var(--accent)] hover:bg-[var(--accent)]/90`. |

---

## Wave 3: Newer Page Fixes (run after Wave 1 + Wave 2 are committed)

Files owned: `src/app/dm-strategy/**`, `src/app/product-agent/**`, `src/app/test-dm-tracker/**`

> Wave 3 agents must NOT touch any file in `src/components/ui/` or `src/app/globals.css` ‚Äî those are owned by Wave 0.

### /dm-strategy

| ID | Severity | File | Description | Fix approach |
|----|----------|------|-------------|--------------|
| W3-DM-001 (dm-001) | P1 | `src/app/dm-strategy/styles.css` | The `:root` block in `styles.css` defines a completely parallel CSS custom property system (`--primary-blue`, `--accent-cyan`, `--text-dark`, `--text-light`, `--background`, etc.) that conflicts with globals.css. It also redefines `--border` to `#E1E8ED` (overriding the shared `#e8e6e1`). This creates a scoped token system that applies to all dm-strategy components. | Remove the entire `:root { }` block from `src/app/dm-strategy/styles.css`. Update all consumer classes within `styles.css` and all dm-strategy components: `--primary-blue` ‚Üí `var(--secondary)`, `--accent-cyan` ‚Üí `var(--accent)`, `--text-dark` ‚Üí `var(--ink)`, `--text-light` ‚Üí `var(--muted)`, `--background` ‚Üí `var(--paper)`, `--white` ‚Üí `white`, `--border` (already in globals as `#e8e6e1`). Audit all `var(--primary-blue)` and `var(--accent-cyan)` references in all dm-strategy files and replace. |
| W3-DM-002 (dm-002) | P1 | `src/app/dm-strategy/components/dm-strategy-hero.tsx` | Hero uses `linear-gradient(135deg, var(--primary-blue) 0%, #004d7a 100%)` ‚Äî a blue gradient ‚Äî and is wrapped in a rounded card rather than being a full-bleed header band. After W3-DM-001, `--primary-blue` will be removed, breaking this gradient. | After W3-DM-001, replace the hero gradient with `className="bg-gradient-to-br from-[var(--secondary)] to-[#1a2332]"`. Remove the `rounded-xl` or similar card wrapper that makes it a contained card. Let it be a full-width section matching the header treatment on /dashboard, /alerts, /query, /scenario. |
| W3-DM-003 (dm-003) | P1 | `src/app/dm-strategy/page.tsx` | Trends link banner uses `bg-gradient-to-r from-blue-600 to-cyan-500` ‚Äî an off-brand Tailwind gradient. | Replace `from-blue-600 to-cyan-500` with `from-[var(--secondary)] to-[#1a2332]` on the trends link banner. |
| W3-DM-004 (dm-004) | P1 | `src/app/dm-strategy/styles.css`, `dm-strategy-hero.tsx`, `recommendation-card.tsx` | `.dm-h1` through `.dm-h4` custom heading classes inherit DM Sans (no `font-family` declaration) instead of Cormorant Garamond. The shared `h1/h2/h3` selector in globals.css would set the font correctly if semantic heading elements were used. | Option A (preferred): Remove the `.dm-h1`‚Äì`.dm-h4` custom classes from `styles.css` and update all usages in components to use semantic `<h1>`‚Äì`<h4>` elements with the `font-display` Tailwind class. Option B: Add `font-family: 'Cormorant Garamond', serif;` to each `.dm-h1`‚Äì`.dm-h4` class in `styles.css`. |
| W3-DM-005 (dm-005) | P1 | `src/app/dm-strategy/components/recommendation-card.tsx`, `dm-trend-chart.tsx` | Hardcoded hex colours in JS config objects and inline styles: `#E74C3C`, `#F39C12`, `#27AE60`, `#95A5A6`, `#0066A1`, `#00B8D4` in `recommendation-card.tsx` priorityConfig and buConfig; `#10B981`, `#EF4444`, `#6B7280`, `#E5E7EB`, `#111827` in `dm-trend-chart.tsx`. | In `recommendation-card.tsx`: replace `#E74C3C` ‚Üí `var(--critical)`, `#F39C12` ‚Üí `var(--warning)`, `#27AE60` ‚Üí `var(--success)`, `#95A5A6` ‚Üí `var(--muted)`, `#0066A1` ‚Üí `var(--secondary)`, `#00B8D4` ‚Üí `var(--accent)`. In `dm-trend-chart.tsx`: replace `#10B981` ‚Üí `var(--success)`, `#EF4444` ‚Üí `var(--critical)`, `#6B7280` ‚Üí `var(--muted)`, `#E5E7EB` ‚Üí `var(--border)`, `#111827` ‚Üí `var(--ink)`. Note: CSS custom properties cannot be used directly in recharts `stroke`/`fill` props ‚Äî use `getComputedStyle(document.documentElement).getPropertyValue('--success')` or extract token values into a constants file that mirrors the globals.css values. |
| W3-DM-006 (dm-006) | P2 | `src/app/dm-strategy/components/portfolio-dashboard.tsx` | `handleDefer()` uses `window.prompt()`. `handleModalSubmit()` and other actions use `window.alert()`. These native browser dialogs are visually inconsistent with the Sonner toast library already in the app. | Remove all `window.prompt()` and `window.alert()` calls. Replace `prompt()` with an inline form state (controlled `<input>` + submit button). Replace all `alert()` calls with `toast('message')` imported from `sonner`. The `Toaster` is already mounted in `layout.tsx`. |
| W3-DM-007 (dm-007) | P2 | `src/app/dm-strategy/page.tsx` | Error state button uses `bg-blue-600 text-white rounded hover:bg-blue-700`. Error card uses `text-red-600` and `border-red-200`. | Replace: `bg-blue-600 hover:bg-blue-700` ‚Üí `bg-[var(--accent)] hover:bg-[var(--accent)]/90`, `text-red-600` ‚Üí `text-[var(--critical)]`, `border-red-200` ‚Üí `border-[var(--critical)]/30`. |
| W3-DM-008 (dm-008) | P2 | `src/app/dm-strategy/page.tsx` | Live data indicator uses `bg-green-50 border-green-200 text-green-800`. | Replace: `bg-green-50` ‚Üí `bg-[var(--success)]/5`, `border-green-200` ‚Üí `border-[var(--success)]/30`, `text-green-800` ‚Üí `text-[var(--ink)]`. The green indicator dot (if present) can remain as `bg-[var(--success)]`. |
| W3-DM-009 (demo-001) | P1 | `src/app/dm-strategy/demo/page.tsx` | Root div uses `style={{background: '#FAFAFA'}}` ‚Äî hardcoded near-white instead of `var(--paper)`. | Replace `background: '#FAFAFA'` with `background: 'var(--paper)'` or add `className="bg-[var(--paper)]"` and remove the inline style. |
| W3-DM-010 (demo-002) | P1 | `src/app/dm-strategy/demo/page.tsx` | Trends link banner uses fully hardcoded `linear-gradient(135deg, #0066A1 0%, #00B8D4 100%)` and `boxShadow` with `rgba(0, 102, 161, 0.3)`. Also uses inline `onMouseEnter`/`onMouseLeave` to directly mutate element style ‚Äî a React anti-pattern. | Replace gradient with `background: 'linear-gradient(135deg, var(--secondary) 0%, #1a2332 100%)'`. Replace `boxShadow rgba(0,102,161,0.3)` with a neutral shadow. Remove `onMouseEnter`/`onMouseLeave` style mutation handlers and replace with a CSS `hover:` Tailwind class. Consider extracting this link into a shared `TrendsLinkBanner` component shared with `dm-strategy/page.tsx` to avoid the duplication. |
| W3-DM-011 (demo-003) | P2 | `src/app/dm-strategy/demo/page.tsx`, `src/app/dm-strategy/page.tsx` | The demo page at `/dm-strategy/demo` is publicly accessible in production via a 'View Demo Page' link shown in the error state of the main page. It contains no auth or environment gating. | Add `if (process.env.NODE_ENV !== 'development') { redirect('/dm-strategy') }` at the top of `demo/page.tsx` server component. Remove or conditionally render the 'View Demo Page' link in the error state of `dm-strategy/page.tsx` so it only appears in development. |
| W3-DM-012 (trends-001) | P1 | `src/app/dm-strategy/trends/page.tsx` | Page header h1 uses `style={{color: '#0066A1'}}` ‚Äî hardcoded primary blue instead of `var(--secondary)`. | Replace `style={{color: '#0066A1'}}` on the h1 with `style={{color: 'var(--secondary)'}}` or add `text-[var(--secondary)]` className. |
| W3-DM-013 (trends-002) | P1 | `src/app/dm-strategy/trends/page.tsx` | Portfolio chart wrapper uses `background: 'linear-gradient(135deg, #0066A1 0%, #004d7a 100%)'`. BU insight cards use hardcoded `borderLeft` colours `#0066A1`, `#00B8D4`, `#27AE60` and hardcoded background tints `#F0F9FF`, `#F0FDFF`, `#F0FDF4`. | Replace gradient with `background: 'linear-gradient(135deg, var(--secondary) 0%, #1a2332 100%)'`. Replace insight card borders: `#0066A1` ‚Üí `var(--secondary)`, `#00B8D4` ‚Üí `var(--accent)`, `#27AE60` ‚Üí `var(--success)`. Replace background tints with `var(--paper)` or `var(--highlight)`. |
| W3-DM-014 (trends-003) | P1 | `src/app/dm-strategy/trends/page.tsx` | Breadcrumb uses raw `<a>` tags with `style={{color: '#0066A1'}}`. Active breadcrumb uses `style={{color: '#111827'}}`. | Replace `<a>` with Next.js `<Link>` components. Apply `style={{color:'var(--secondary)'}}` for link colour. Apply `style={{color:'var(--ink)'}}` for active breadcrumb. |
| W3-DM-015 (trends-004) | P1 | `src/app/dm-strategy/trends/page.tsx` | Root div uses `style={{background: '#FAFAFA'}}`. | Replace with `style={{background: 'var(--paper)'}}` or `className="bg-[var(--paper)]"`. |
| W3-DM-016 (trends-005) | P1 | `src/app/dm-strategy/trends/page.tsx` | Trends page is presented as a live user-facing feature but only consumes static mock data from `../demo/demo-data`. Users see charts that appear to reflect real business metrics but are actually hardcoded demo values. | Add a clearly visible "Demo Data" notice banner at the top of the trends page (use a `bg-[var(--warning)]/10 border border-[var(--warning)]/30 text-[var(--ink)]` banner with text: "Note: This page is displaying sample data. Live data integration is in progress."). Mark as a roadmap item. Until real data is connected, the banner is mandatory so as not to mislead stakeholders. |
| W3-DM-017 (trends-006) | P2 | `src/app/dm-strategy/components/dm-trend-chart.tsx` | Hardcoded `'#10B981'` and `'#EF4444'` for peak/trough stat labels ‚Äî not matching `--success` `(#4caf50)` or `--critical` `(#e53935)`. (Overlaps with W3-DM-005 ‚Äî address together.) | Covered by W3-DM-005. Ensure both files are addressed in the same pass. |

### /product-agent

| ID | Severity | File | Description | Fix approach |
|----|----------|------|-------------|--------------|
| W3-PA-001 **(P0)** (pa-004) | P0 | `src/app/product-agent/page.tsx`, `src/app/product-agent/test-analysis/page.tsx` | Two navigation buttons link to non-existent routes: `/product-agent/submit-request` (Submit Request button) and `/product-agent/backlog` (View Backlog button). These are hard 404s. The `test-analysis` page also links to `/product-agent/backlog`. | Disable or replace the broken links until the routes are implemented: (1) Change the "Submit Request" and "View Backlog" `<Link>` components to `<button type="button">` with `disabled` and `title="Coming soon"` attributes. (2) Style disabled state with `opacity-50 cursor-not-allowed`. (3) Optionally add a `(Coming Soon)` label. (4) Remove the broken link to `/product-agent/backlog` from `test-analysis/page.tsx`. |
| W3-PA-002 (pa-001) | P1 | `src/app/product-agent/page.tsx` | Entire page uses Tailwind semantic colour classes (`text-gray-900`, `bg-gray-50`, `text-blue-600`, `text-green-600`, `text-purple-600`, `text-orange-600`, `bg-blue-100`, `bg-green-100`, `bg-purple-100`) with zero editorial CSS variable usage. Page background is `bg-gray-50` instead of `bg-[var(--paper)]`. | Systematic replacement in `product-agent/page.tsx`: `bg-gray-50` ‚Üí `bg-[var(--paper)]`, `text-gray-900` ‚Üí `text-[var(--ink)]`, `text-gray-600`/`text-gray-500` ‚Üí `text-[var(--muted)]`, `text-blue-600` ‚Üí `text-[var(--secondary)]`, `text-green-600` ‚Üí `text-[var(--success)]`, `text-purple-600` ‚Üí `text-[var(--accent)]`, `text-orange-600` ‚Üí `text-[var(--warning)]`, `bg-blue-100`/`bg-green-100`/`bg-purple-100` ‚Üí `bg-[var(--highlight)]`. Replace `shadow-md` card styles with `border border-[var(--border)]`. |
| W3-PA-003 (pa-002) | P1 | `src/app/product-agent/page.tsx` | Page `<h1>` uses `text-4xl font-bold text-gray-900` ‚Äî DM Sans with font-bold (700) inherited. Editorial system specifies Cormorant Garamond at font-weight 300 for h1 via globals.css, but the `font-bold` Tailwind class overrides the weight. | Add `font-display` class to the `<h1>` element. Remove `font-bold`. Add `font-light` or `font-[300]` to match globals.css h1 specification. Replace `text-gray-900` with `text-[var(--secondary)]` or use the inherited colour from `h1` rule in globals.css (which sets color to `var(--secondary)` for `h2`). |
| W3-PA-004 (pa-003) | P1 | `src/app/product-agent/page.tsx` | "Ready to Get Started?" CTA section uses `bg-gradient-to-r from-blue-500 to-purple-600` ‚Äî blue-to-purple gradient, completely off-brand. Button within uses `bg-white text-blue-600`. | Replace `from-blue-500 to-purple-606` with `from-[var(--secondary)] to-[#1a2332]`. Change button `text-blue-600` to `text-[var(--secondary)]`. |
| W3-PA-005 (ta-001) | P1 | `src/app/product-agent/test-analysis/page.tsx` | Same systematic design token violation as parent: all styling uses `bg-gray-50`, `text-gray-900`, `bg-blue-600`, `border-gray-300` etc. | Apply identical token replacement as W3-PA-002 to `test-analysis/page.tsx`. |
| W3-PA-006 (ta-002) | P1 | `src/app/product-agent/test-analysis/page.tsx` | h1 uses `text-4xl font-bold text-gray-900`. The `font-bold` (700) overrides the globals.css `h1` weight of 300, creating a specificity conflict. The serif font is applied by globals.css but the weight is wrong. | Same fix as W3-PA-003: add `font-display` class, remove `font-bold`, add `font-light` or `font-[300]`. Replace `text-gray-900` with `text-[var(--ink)]`. |
| W3-PA-007 (ta-003) | P1 | `src/app/product-agent/test-analysis/page.tsx` | PRD generation progress banner and "Next Steps" CTA use `bg-gradient-to-r from-blue-600 to-purple-600`. "Run Analysis" button uses `bg-blue-600`. | Replace `from-blue-600 to-purple-600` with `from-[var(--secondary)] to-[#1a2332]`. Replace `bg-blue-600` CTA buttons with `bg-[var(--accent)]` or `bg-[var(--secondary)]`. |
| W3-PA-008 (ta-004) | P2 | `src/app/product-agent/test-analysis/page.tsx` | Page copy says "This is a test environment" ‚Äî this page has no access gating and is linked from production navigation. | Either: (A) Add `if (process.env.NODE_ENV !== 'development') { redirect('/product-agent') }` at the top of the server component. Or (B) Remove the "test environment" language and rebrand as a legitimate "Run Analysis" feature page. Decision required by product team; flag as a policy item. |

### /test-dm-tracker

| ID | Severity | File | Description | Fix approach |
|----|----------|------|-------------|--------------|
| W3-TDM-001 (tdmt-001 + tdmt-002 + tdmt-003) | P1/P2 | `src/app/test-dm-tracker/page.tsx` | This is a publicly accessible developer test scaffold (`/test-dm-tracker`). It creates a custom gradient header (`#1e3c72`/`#2a5298`) that renders below the shared NavBar, creating two visible header bands. The page comment explicitly says "Test page for DM Tracker component". It has no auth or environment gating. | **Recommended action: Delete the route.** Run `rm -rf src/app/test-dm-tracker/` to remove the page entirely. If the DM Tracker component needs to remain testable, gate it behind `NODE_ENV === 'development'` in a `/dev/dm-tracker` route that is not linked from any navigation. If deletion is not yet approved, as a minimum add `if (process.env.NODE_ENV !== 'development') { redirect('/dm-strategy') }` at the top of the server component to prevent production access. |

---

## Deferred / Out of Scope

The following issues require significant new feature development, new data pipeline work, or product decisions beyond CSS/JSX fixes. They should NOT be attempted in the current fix wave and should be moved to the product backlog.

| ID | Issue | Reason deferred |
|----|-------|-----------------|
| acct-007 (charts) | Add real Chart.js/recharts charts to the account plan Overview tab (ARR by Entity doughnut + Customer Concentration pie) | Requires confirmed data shape from the subscriptions/revenue data model. Chart library choice needs to be standardized across the app (recharts exists in dm-strategy; Chart.js in Telstra reference). This is a feature build, not a fix. |
| acct-020 (charts) | Two recharts charts for Financial tab (Revenue Growth Projection bar + Top 10 Customers comparison) | Same as above ‚Äî requires real data pipeline, chart library decision. |
| acct-012 (Key Executives tab ‚Äî decision matrix) | The 2x2 decision maker/influencer matrix requires a `supporterOrDetractor` boolean field added to the Stakeholder data type and populated in the data layer | Data model change required before UI can be built. |
| acct-014 (pain point data model) | Adding `budget`, `solution`, `nextAction` fields to the PainPoint type and populating them from the data source | Data model and data layer change required before UI table columns can render real values. |
| acct-016 (competitive data model) | Adding `threatLevel`, `customerSponsor`, `risk`, `differentiation`, `nextAction` to the Competitor type | Same ‚Äî data model change needed first. |
| trends-005 | Connect `/dm-strategy/trends` page to real live data (currently only uses static demo data) | Requires building a real trends data provider function. Cannot be fixed by CSS/JSX changes alone. |
| ta-004 / demo-003 | Product decision: are `/product-agent/test-analysis` and `/dm-strategy/demo` internal developer tools or user-facing features? | Business/product decision required before implementing access controls. |
| acct-000 (British Telecommunications 404) | Depends on confirming the canonical customer name in the production data set | Investigation needed in the data layer ‚Äî may require a data fix, not just a code fix. Wave 1 agent should investigate and report back if the root cause is a data issue rather than a name-matching bug. |

---

## Risk Flags

| Risk | Affected Area | Mitigation |
|------|--------------|------------|
| **W0-003: Changing `.card-hover` in globals.css affects ALL pages** | Every page using `Card` component or `.card-hover` class (dashboard, accounts, alerts, query, scenario, account plan) | The change is a reduction (4px ‚Üí 2px lift, lighter shadow). Test all pages visually after applying. Lower risk than the alternative of leaving it. |
| **W0-004: Changing `.skeleton` colours in globals.css** | All loading skeletons across the app | All skeletons use `animate-pulse` in combination with inline `bg-slate-200` ‚Äî changing globals.css skeleton will not affect them until the inline classes are also replaced (Wave 2 fixes those). Safe to apply in Wave 0 as it won't retroactively break existing overriding classes. |
| **W0-005: Adding `relative overflow-hidden` to Card component** | Every card in the app that renders content using absolute positioning inside the card | The `overflow-hidden` addition to Card could clip absolutely-positioned child elements (e.g. dropdown menus, tooltips). Search for any Card usage that has `absolute`-positioned children before applying. Known safe usages: dashboard KPI cards, account plan stat cards, overview cards. |
| **W3-DM-001: Removing `:root` from dm-strategy/styles.css** | All dm-strategy components that consume `var(--primary-blue)`, `var(--accent-cyan)`, etc. | After removing the `:root` block, ALL `var(--primary-blue)` and `var(--accent-cyan)` references in dm-strategy components will fall through to `var(--secondary)` and `var(--accent)` in globals.css (correct behaviour). But `var(--border)` conflict: styles.css `:root` sets `--border: #E1E8ED` while globals.css sets `#e8e6e1`. Removing the styles.css `:root` will switch dm-strategy borders from `#E1E8ED` to `#e8e6e1` ‚Äî a very minor visual change but confirm no component relies on the slightly bluer dm-strategy border value. |
| **W3-DM-005: CSS custom properties in recharts stroke/fill props** | `dm-trend-chart.tsx` recharts colour props | Recharts `stroke` and `fill` props are SVG attributes and may not resolve CSS custom properties in all browsers. Extract token values into a `designTokens` constants file: `export const tokens = { success: '#4caf50', critical: '#e53935', ... }` mirroring globals.css, and use those constants in recharts props instead of `var(--success)` strings. |
| **Wave 1 P0: British Telecommunications 404 investigation** | `src/app/accounts/[name]/page.tsx` and data layer | If the 404 is caused by a data issue (the customer literally does not exist in the dataset) rather than a name-matching bug, the fix is in the data layer, not the UI code. Wave 1 agent must investigate `getAllCustomersWithHealth()` return values and report back before the UI fix can be confirmed. |
| **Wave 1: Splitting Organization tab into two tabs** | `tab-navigation.tsx`, `organization-tab.tsx`, URL param routing | If the current tab is driven by a URL search param (`?tab=organization`), existing bookmarks or links will break when the tab key changes to `key-executives` or `org-structure`. Ensure the old `organization` key either redirects or is an alias for `org-structure` in the tab switching logic. |
