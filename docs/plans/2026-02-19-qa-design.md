# QA, Bugfix & Visual Design Improvement — Design Doc

**Date:** 2026-02-19
**Scope:** All pages — core 6 first, then dm-strategy and product-agent routes
**Approach:** Option C — Tiered Parallel Agents

---

## Problem Statement

The Skyvera BI Platform has 13 pages across 8 routes. After 6 phases of development, some pages have:
- Visual drift from reference HTML designs (typography, color, layout)
- Functional/rendering issues (crashes, broken interactions, data not loading)
- Polish gaps (spacing, hover states, inconsistencies)

The `Telstra_Account_Plan_Interactive.html` file is the explicit design reference for all account plan pages.

---

## Architecture

Three tiers execute in sequence. No code is touched until Tier 2 has a full picture.

```
TIER 1 — Parallel Audit (3 agents simultaneously)
├── Agent A: Core Pages
│   └── /, dashboard, accounts, alerts, query, scenario
├── Agent B: Account Plan
│   └── /accounts/[name] — audited against Telstra_Account_Plan_Interactive.html
└── Agent C: Newer Pages
    └── dm-strategy (3 sub-pages), product-agent (2 sub-pages), test-dm-tracker

TIER 2 — Orchestrator (1 agent)
└── Reads all 3 JSON reports → deduplicates → assigns priority → produces Fix Manifest

TIER 3 — Parallel Fix (agents per cluster)
├── Shared Component Fix Agent (globals.css, layout.tsx, shared UI — runs FIRST)
└── Page Fix Agents (dispatched after shared fixes land, page-specific files only)
```

---

## Audit Agent Output Format

Each Tier 1 agent produces a JSON report per page:

```json
{
  "page": "/dashboard",
  "issues": [
    {
      "id": "dash-001",
      "severity": "P0 | P1 | P2",
      "type": "crash | visual | functional | design",
      "description": "...",
      "files_affected": ["src/app/dashboard/components/revenue-chart.tsx"],
      "shared_component": false,
      "fix_approach": "..."
    }
  ]
}
```

**Severity scale:**
- `P0` — page crashes, data doesn't load, interaction broken
- `P1` — visual drift from reference, layout broken, typography wrong
- `P2` — polish (spacing, hover states, color inconsistencies)

---

## Orchestrator (Tier 2)

Reads all 3 JSON reports and produces a **Fix Manifest** ordered by:

1. Shared component issues (affect 2+ pages) → fixed first
2. Account plan fixes → uses Telstra HTML as pixel reference
3. Core page fixes → one fix agent per page (parallel)
4. Newer page fixes → dm-strategy and product-agent (parallel)

---

## Fix Agent Rules

- Each fix agent receives a `DO NOT TOUCH` list of files owned by other agents
- Shared components are frozen after the shared fix agent completes
- Account Plan fix agent gets the `frontend-design` skill and Telstra HTML as reference
- All fixes committed atomically per agent with descriptive commit messages

---

## Outputs

- `docs/qa-report/2026-02-19-qa-audit.md` — consolidated issue list with fix status
- Git commits per fix agent (atomic, attributable)
- Final Playwright screenshot pass confirming all fixes

---

## Pages in Scope

| Route | Agent | Priority |
|-------|-------|----------|
| `/` | A | Core |
| `/dashboard` | A | Core |
| `/accounts` | A | Core |
| `/alerts` | A | Core |
| `/query` | A | Core |
| `/scenario` | A | Core |
| `/accounts/[name]` | B | Account Plan (Telstra ref) |
| `/dm-strategy` | C | Newer |
| `/dm-strategy/demo` | C | Newer |
| `/dm-strategy/trends` | C | Newer |
| `/product-agent` | C | Newer |
| `/product-agent/test-analysis` | C | Newer |
| `/test-dm-tracker` | C | Newer |
